<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Data Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: #eef1f6;
        }

        .sidebar {
            width: 250px;
            background: #2c3e50;
            color: white;
            padding: 20px;
            position: fixed;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .sidebar h2 {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .content {
            margin-left: 270px;
            padding: 20px;
            width: 100%;
        }

        .container {
            max-width: 700px;
            margin: 20px auto;
            background: #495e74;
            padding: 20px;
            box-shadow: 0 4px 10px white;
            border-radius: 10px;
        }

        .dataset-info {
            background: #fff;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .dataset-info h3 {
            color: #2980b9;
        }

        .dataset-info p {
            font-size: 16px;
            color: #333;
        }

        .tabs {
            display: flex;
            cursor: pointer;
        }

        .tab {
            padding: 10px;
            background: #3498db;
            color: white;
            margin-right: 10px;
            border-radius: 5px;
        }

        .tab.active {
            background: #1f6691;
        }

        .chart-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            height: 250px;
        }

        canvas {
            background: rgb(247, 247, 247);
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px ;
            height: 100px;
            width: 100% !important;
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 10px;
            height:250px;
        }

        button {
            background: #2980b9;
            color:white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #1f6691;
        }

        label {
            color: white;
        }
    </style>
</head>
<body>

    <!-- Sidebar -->
    <div class="sidebar">
        <h2>Dashboard</h2>
        <p>Upload a CSV or JSON file.</p>
        <input type="file" id="fileInput" accept=".csv, .json">
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Tabs for navigating between sections -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('metadata')">Data Insights</div>
            <div class="tab" onclick="switchTab('presentatin')" > <a href="presentatin.html">Data Visualization</a></div>
        </div>

        <!-- Data Insights Section (Page 1) -->
        <div id="metadata" class="container">
            <h2><center>Data Insights</center></h2>
            <div class="dataset-info" id="datasetMetadata"></div>
        </div>

        <!-- Data Visualization Section (Page 2) -->
        <div id="visualization" class="container" style="display:none;">
            <h2 style="color: white;"><center>Data Visualization</center></h2>
            <p style="color: white;">Select which chart types to display.</p>
            <div class="controls">
                <div>
                    <input type="checkbox" id="barChart" /> <label for="barChart">Bar Chart</label>
                </div>
                <div>
                    <input type="checkbox" id="lineChart" /> <label for="lineChart">Line Chart</label>
                </div>
                <div>
                    <input type="checkbox" id="pieChart" /> <label for="pieChart">Pie Chart</label>
                </div>
                <div>
                    <input type="checkbox" id="doughnutChart" /> <label for="doughnutChart">Doughnut Chart</label>
                </div>
                <div>
                    <input type="checkbox" id="radarChart" /> <label for="radarChart">Radar Chart</label>
                </div>
                <div>
                    <input type="checkbox" id="polarAreaChart" /> <label for="polarAreaChart">Polar Area Chart</label>
                </div>
                <button onclick="generateSelectedCharts()">Generate Selected Charts</button>
            </div>
            <div class="chart-container" id="chartContainer"></div>
        </div>
    </div>

    <script>
        let chartInstances = [];
        let chartTypes = {
            bar: 'bar',
            line: 'line',
            pie: 'pie',
            doughnut: 'doughnut',
            radar: 'radar',
            polarArea: 'polarArea'
        };

        document.getElementById('fileInput').addEventListener('change', handleFile);

        function handleFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function (e) {
                const content = e.target.result;
                file.name.endsWith('.csv') ? processCSV(content) : processJSON(content);
            };
            reader.readAsText(file);
        }

        function processCSV(content) {
            const rows = content.trim().split('\n').map(row => row.split(','));
            const columns = rows[0];
            const rowCount = rows.length - 1;
            let missingData = columns.map(() => 0);
            let categoricalColumns = {};

            for (let i = 1; i < rows.length; i++) {
                for (let j = 0; j < columns.length; j++) {
                    if (!rows[i][j]) {
                        missingData[j]++;
                    } else {
                        if (isNaN(rows[i][j])) {
                            if (!categoricalColumns[columns[j]]) categoricalColumns[columns[j]] = {};
                            categoricalColumns[columns[j]][rows[i][j]] = (categoricalColumns[columns[j]][rows[i][j]] || 0) + 1;
                        }
                    }
                }
            }

            displaySummary("CSV", rowCount, columns, missingData, categoricalColumns);
        }

        function processJSON(content) {
            try {
                const jsonData = JSON.parse(content);
                const keys = Object.keys(jsonData[0]);
                const rowCount = jsonData.length;
                let missingData = keys.map(() => 0);
                let categoricalColumns = {};

                jsonData.forEach(item => {
                    keys.forEach((key, idx) => {
                        if (!item[key]) {
                            missingData[idx]++;
                        } else {
                            if (isNaN(item[key])) {
                                if (!categoricalColumns[key]) categoricalColumns[key] = {};
                                categoricalColumns[key][item[key]] = (categoricalColumns[key][item[key]] || 0) + 1;
                            }
                        }
                    });
                });

                displaySummary("JSON", rowCount, keys, missingData, categoricalColumns);
            } catch {
                document.getElementById('datasetMetadata').innerText = 'Invalid JSON file.';
            }
        }

        function displaySummary(fileType, rowCount, columns, missingData, categoricalColumns) {
            let summaryHTML = `
                <p><strong>File Type:</strong> ${fileType}</p>
                <p><strong>Number of Rows:</strong> ${rowCount}</p>
                <p><strong>Columns:</strong> ${columns.join(', ')}</p>
                <p><strong>Missing Data:</strong></p>
                <ul>${columns.map((col, idx) => `<li>${col}: ${missingData[idx]} missing</li>`).join('')}</ul>
            `;

            Object.keys(categoricalColumns).forEach(col => {
                let sortedValues = Object.entries(categoricalColumns[col])
                    .sort((a, b) => b[1] - a[1]) // Sort by frequency (highest first)
                    .slice(0, 3) // Keep only the top 3 most frequent values
                    .map(([value, count]) => `${value} (${count} times)`) // Format for display
                    .join(", ");

                summaryHTML += `<p><strong>${col} - Top Values:</strong> ${sortedValues}</p>`;
            });

            document.getElementById('datasetMetadata').innerHTML = summaryHTML;
        }

        function generateSelectedCharts() {
            const fileInput = document.getElementById('fileInput');
            if (fileInput.files.length > 0) {
                const fileEvent = new Event('change');
                fileInput.dispatchEvent(fileEvent);
            } else {
                alert("Please upload a dataset first.");
            }
        }

        function switchTab(tab) {
            if (tab === 'metadata') {
                document.getElementById('metadata').style.display = 'block';
                document.getElementById('visualization').style.display = 'none';
                document.querySelector('.tab.active').classList.remove('active');
                document.querySelector('.tab:nth-child(1)').classList.add('active');
            } else {
                document.getElementById('metadata').style.display = 'none';
                document.getElementById('visualization').style.display = 'block';
                document.querySelector('.tab.active').classList.remove('active');
                document.querySelector('.tab:nth-child(2)').classList.add('active');
            }
        }
        
    </script>
    
</body>
</html>